(this["webpackJsonpaxelor-assignment-builder"]=this["webpackJsonpaxelor-assignment-builder"]||[]).push([[0],{152:function(e,t,a){},153:function(e,t,a){},173:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(20),c=a.n(o),i=(a(152),a(14)),l=(a(153),a(8)),u=a.n(l),s=a(31),d=a(18),f=a(19),b=a(5),m=a(225),p=a(244),j=a(237),v=a(73),O=a(131),h=a(221),g=a(127),x=a.n(g),y=a(128),C=a.n(y),w=a(51),F=a(55),k=a.n(F),N=a(24),S=a(178),M=a(240),T=a(113),_=a.n(T),E=["createdBy","createdOn","updatedBy","updatedOn","version","id"],R={CONTEXT:"context",SELF:"self",NONE:"none",SOURCE:"source",PARENT:"parent"},P="CUSTOM",L={date:"DD/MM/YYYY",time:"HH:mm:ss",datetime:"DD/MM/YYYY HH:mm"},I=["one_to_one","many_to_one","many_to_many","one_to_many","json_one_to_one","json_many_to_one","json_many_to_many","json_one_to_many"],A=["many_to_many","one_to_many","json_many_to_many","json_one_to_many"],V=["panel","label","spacer","button"],B=a(12);function J(e,t,a,n){t.json;var r=[],o=function(e){var t,r,o=e.value,c=(e.contextModel,e.modelSubField),i=(e.selfField,e.subFieldName,e.sourceField,o&&o.from||a),l=null===o||void 0===o?void 0:o.selected,u=function(e){var t="";return e&&e.forEach((function(e){if(e.name){var a=xe(e.name);t=t?"".concat(t,"?.").concat(a):"".concat(a)}})),t}(c);e.type.toLowerCase();if(i===R.CONTEXT&&(l=u?{value:u}:null),i===R.SOURCE)if(u){var s=c[0];l=s&&n.fullName===s.fullName?{value:"SOURCE"}:{value:u}}else l=null;if(i===R.SELF&&(l=u?{value:u}:null),[R.PARENT].includes(i)&&(null===(t=l)||void 0===t?void 0:t.value)&&"object"===typeof(null===(r=l)||void 0===r?void 0:r.value)){var d=xe(l.value.name);l=u?{value:"".concat(d,"?.").concat(u)}:{value:d}}return l||null};return e.forEach((function(e){e.name,e.subFieldName,e.contextModel;var n=e.value,c=e.dataPath,i=(e.target,e.type),l=Object(b.a)({},n),u=l||{},s=u.fields,d=(u.selected,function(e){return e.target?e.target.split(".").pop():null}(e)),f=e.targetModel,m=e.jsonTarget,p=e.jsonModel;if("object"===typeof s&&s&&(l.fields=J(n.fields,t)),l.selected=o(e),l&&!l.from&&(l.from=a),!e.isRemoved&&l.selected&&![void 0,null].includes(l.selected.value)){var j={dataPath:c,type:i,target:d||void 0,targetModel:f||void 0,jsonTarget:m||void 0,value:l,name:e.name,jsonModel:p||void 0,modelSubField:e.modelSubField||void 0,sourceField:e.sourceField||void 0,selfField:e.selfField||void 0};r.push(JSON.parse(JSON.stringify(j)))}})),r}var K,U=a(114),H=a(115),D={};var z=new(function(){function e(){Object(U.a)(this,e);var t=new Headers;t.append("Accept","application/json"),t.append("Content-Type","application/json"),t.append("X-Requested-With","XMLHttpRequest"),t.append("X-CSRF-Token",function(e){var t=document.cookie||"";return t!==K&&(K=t,D=t.split("; ").reduce((function(e,t){var a=t.split("=");return e[a[0]]=a[1],e}),{})),D[e]}("CSRF-TOKEN")),this.baseURL="..",this.headers=t}return Object(H.a)(e,[{key:"fetch",value:function(e){function t(t,a,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t,a){return fetch(e,a).then((function(e){return-1!==["head","delete"].indexOf(t.toLowerCase())?e:e.headers.get("content-type").includes("application/json")?e.json():e})).catch((function(e){}))}))},{key:"request",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=Object.assign({method:"POST",credentials:"include",headers:this.headers,mode:"cors",body:JSON.stringify(a)},t);return"GET"===t.method&&delete n.body,this.fetch("".concat(this.baseURL).concat(0===e.indexOf("/")?e:"/".concat(e)),t.method,n)}},{key:"get",value:function(e){return this.request(e,{method:"GET"})}},{key:"post",value:function(e,t){return this.request(e,{method:"POST"},t)}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=Object(b.a)({offset:0},t),n="ws/rest/".concat(e,"/search");return this.post(n,a)}},{key:"fields",value:function(e){return this.post("/ws/meta/view/fields",e)}},{key:"fetchFields",value:function(e){var t="/ws/meta/fields/".concat(e);return this.get(t)}},{key:"fetchRecord",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n="ws/rest/".concat(e,"/").concat(t,"/fetch");return this.post(n,a)}},{key:"add",value:function(e,t){var a={data:t},n="ws/rest/".concat(e);return this.post(n,a)}},{key:"action",value:function(e,t){return this.post("/ws/action/"+e,t)}}]),e}());function W(e){return X.apply(this,arguments)}function X(){return(X=Object(d.a)(u.a.mark((function e(t){var a,n,r,o,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.post("ws/rest/com.axelor.meta.db.MetaSelect/search",{data:{_domain:"self.name = :name",_domainContext:{name:t}},fields:["name","items"],offset:0,limit:1,sortBy:null});case 2:if(a=e.sent,n=a.data,!(r=n&&n[0])){e.next=12;break}return o=r.items,e.next=9,z.post("ws/rest/com.axelor.meta.db.MetaSelectItem/search",{data:{_domain:"self.id in (:list)",_domainContext:{list:o.map((function(e){return e.id}))}},fields:["title","value","color","data","order"],offset:0,limit:-1,sortBy:["order"]});case 9:return c=e.sent,i=c.data,e.abrupt("return",i);case 12:return e.abrupt("return",[]);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(){return q.apply(this,arguments)}function q(){return(q=Object(d.a)(u.a.mark((function e(){var t,a,n,r,o,c,i,l=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=l.length>0&&void 0!==l[0]?l[0]:{},a=l.length>1?l[1]:void 0,e.t1=!a||"metaModel"===a,!e.t1){e.next=7;break}return e.next=6,Z(t);case 6:e.t1=e.sent;case 7:if(e.t0=e.t1,e.t0){e.next=10;break}e.t0=[];case 10:if(n=e.t0,e.t3=!a||"metaJsonModel"===a,!e.t3){e.next=16;break}return e.next=15,ee(t);case 15:e.t3=e.sent;case 16:if(e.t2=e.t3,e.t2){e.next=19;break}e.t2=[];case 19:for(r=e.t2,o=[],c=0;c<n.length;c++)o.push(Object(b.a)(Object(b.a)({},n[c]),{},{type:"metaModel"}));for(i=0;i<r.length;i++)o.push(Object(b.a)(Object(b.a)({},r[i]),{},{type:"metaJsonModel"}));return e.abrupt("return",o||[]);case 24:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function G(e){return Q.apply(this,arguments)}function Q(){return(Q=Object(d.a)(u.a.mark((function e(t){var a,n,r,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=null,e.next=3,z.search("com.axelor.meta.db.MetaModel",{data:{criteria:[{fieldName:"name",operator:"=",value:t}]},fields:["name","metaFields","id","fullName"]});case 3:if((n=e.sent)&&-1!==n.status&&(r=(n||{}).data,a=(void 0===r?[]:r)[0]||null),a){e.next=11;break}return o=[{fieldName:"name",operator:"=",value:t}],e.next=9,ee(o);case 9:c=e.sent,a=c[0];case 11:return e.abrupt("return",a||null);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){return $.apply(this,arguments)}function $(){return($=Object(d.a)(u.a.mark((function e(t){var a,n,r,o,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=[],t&&t.search&&a.push({fieldName:"fullName",operator:"like",value:t.search}),e.next=4,z.search("com.axelor.meta.db.MetaModel",{data:{criteria:a},fields:["name","metaFields","id","fullName"]});case 4:return n=e.sent,r=[],t&&t.search&&r.push({fieldName:"name",operator:"like",value:t.search}),e.next=9,ee(r);case 9:if(o=e.sent,!n||-1!==n.status){e.next=12;break}return e.abrupt("return",[]);case 12:return c=(n||{}).data,i=void 0===c?[]:c,e.abrupt("return",[].concat(Object(f.a)(i),Object(f.a)(o)));case 14:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ee(){return te.apply(this,arguments)}function te(){return(te=Object(d.a)(u.a.mark((function e(){var t,a,n,r,o=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=o.length>0&&void 0!==o[0]?o[0]:{},e.next=3,z.search("com.axelor.meta.db.MetaJsonModel",{data:{criteria:t}});case 3:if(!(a=e.sent)||-1!==a.status){e.next=6;break}return e.abrupt("return",[]);case 6:return n=(a||{}).data,r=void 0===n?[]:n,e.abrupt("return",r.map((function(e){return Object(b.a)(Object(b.a)({},e),{},{modelType:P})})));case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(d.a)(u.a.mark((function e(t){var a,n,r,o,c,i,l,s,d,b,m,p,j,v,O=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O.length>1&&void 0!==O[1]&&O[1],a=[],n="".concat(t.fullName||t.target),t.modelType!==P&&n){e.next=24;break}return r=[{fieldName:"jsonModel.name",operator:"=",value:t.name}],o={criteria:r},e.next=8,z.search("com.axelor.meta.db.MetaJsonField",{data:o,fields:["type","nameField","required","model","targetModel","targetJsonModel","targetJsonModel.name","modelField","jsonModel","title","name","selection"],sortBy:["title"]});case 8:c=e.sent,i=(c||{}).data,l=void 0===i?[]:i,s=0;case 11:if(!(s<l.length)){e.next=22;break}if(!(d=l[s]).selection){e.next=18;break}return e.next=16,W(d.selection);case 16:b=e.sent,d.selectionList=b;case 18:a.push(d);case 19:s++,e.next=11;break;case 22:e.next=32;break;case 24:return e.next=26,z.fetchFields(n);case 26:if(!(m=e.sent)||-1!==m.status){e.next=29;break}return e.abrupt("return",[]);case 29:p=(m||{}).data,j=void 0===p?[]:p,a=Object(f.a)(j.fields),Object.keys(j.jsonFields).forEach((function(e){var t,n=j.jsonFields[e];(t=a).push.apply(t,Object(f.a)(Object.values(n)))}));case 32:return v=we(a,"title"),e.abrupt("return",v.filter((function(e){return!V.includes(e.type)})));case 34:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e){return oe.apply(this,arguments)}function oe(){return(oe=Object(d.a)(u.a.mark((function e(t){var a,n,r,o,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.targetModel){e.next=7;break}return e.next=3,ae({fullName:t.targetModel});case 3:return a=e.sent,e.abrupt("return",a);case 7:if(!t.targetJsonModel){e.next=15;break}return n=[{fieldName:"jsonModel.id",operator:"=",value:t.targetJsonModel.id}],r={criteria:n},e.next=12,z.search("com.axelor.meta.db.MetaJsonField",{data:r,fields:["type","nameField","required","model","targetModel","targetJsonModel","targetJsonModel.name","modelField","jsonModel","title","name"],sortBy:["title"]});case 12:return o=e.sent,c=(o||{}).data,i=void 0===c?[]:c,e.abrupt("return",Object(f.a)(i));case 15:return e.abrupt("return",[]);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(e,t){return ie.apply(this,arguments)}function ie(){return(ie=Object(d.a)(u.a.mark((function e(t,a){var n,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.add(t.model,a);case 2:if(!(n=e.sent)||-1!==n.status){e.next=5;break}return e.abrupt("return",null);case 5:return r=(n||{}).data,o=void 0===r?[]:r,e.abrupt("return",o[0]||null);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e,t){return ue.apply(this,arguments)}function ue(){return(ue=Object(d.a)(u.a.mark((function e(t,a){var n,r,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.fetchRecord(t,a);case 2:if(!(n=e.sent)||-1!==n.status){e.next=5;break}return e.abrupt("return",null);case 5:return r=(n||{}).data,o=void 0===r?[]:r,e.abrupt("return",o[0]||null);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function se(e){return de.apply(this,arguments)}function de(){return(de=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.search("com.axelor.meta.db.MetaJsonRecord",{data:{_domain:t}});case 2:if(!(a=e.sent)||-1!==a.status){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",a&&a.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function fe(e){return be.apply(this,arguments)}function be(){return(be=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.search("com.axelor.meta.db.MetaJsonField",{data:{_domain:"self.jsonModel.name = '".concat(t,"' and self.nameField = true")},fields:["name"]});case 2:if(!((a=e.sent)&&a.status>-1)){e.next=5;break}return e.abrupt("return",a.data&&a.data[0]);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function me(e){return pe.apply(this,arguments)}function pe(){return(pe=Object(d.a)(u.a.mark((function e(t){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z.search(t);case 2:if(!(a=e.sent)||-1!==a.status){e.next=5;break}return e.abrupt("return",[]);case 5:return e.abrupt("return",a&&a.data);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function je(e,t){return ve.apply(this,arguments)}function ve(){return(ve=Object(d.a)(u.a.mark((function e(t,a){var n,r,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"action-mapper-method-create-script-from-json",n={data:{context:{_model:a,_jsonString:t}}},e.next=4,z.action("action-mapper-method-create-script-from-json",n);case 4:if(r=e.sent,o=r.data,c=void 0===o?[]:o,!(Array.isArray(c)&&c[0]&&c[0].values&&c[0].values._scriptString)){e.next=9;break}return e.abrupt("return",c[0].values._scriptString);case 9:return e.abrupt("return",void 0);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Oe=a(50),he=a.n(Oe);function ge(e,t){var a=r.a.useRef(null),n=function(){return a.current&&clearTimeout(a.current)},o=function(e){return a.current=setTimeout(e,t)};return r.a.useEffect((function(){return function(){return n()}}),[]),function(){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];n(),o((function(){return e.apply(void 0,a)}))}}function xe(e){if(e)return e.charAt(0).toLowerCase()+e.slice(1)}function ye(e){if(e)return e.charAt(0).toUpperCase()+e.slice(1)}function Ce(e){return window._t&&"string"===typeof e?window._t(e):e}function we(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e.sort((function(e,a){var n=e[t],r=a[t];return n<r?-1:n>r?1:0}))}function Fe(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.replace(/-/g,"_").toLowerCase()},n=[].concat(Object(f.a)(E),Object(f.a)(t)),r=e.filter((function(e){return-1===n.indexOf(e.name)}));return r.filter((function(e){return!A.includes(a(e.type))}))}function ke(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=e.replace(/-/g,"_").toLowerCase();return-1!==I.indexOf(t)}function Ne(e){var t=e.targetName,a=(e.name,e.name);return t&&(a="".concat(a,".").concat(t)),a}var Se=a(4),Me=function(e){return"_selectId"===e?"id":e},Te=Object(S.a)((function(e){return{listbox:{maxHeight:"300px !important"}}}));function _e(e){var t=Object(n.useState)(!1),a=Object(i.a)(t,2),o=a[0],c=a[1],l=Object(n.useState)([]),s=Object(i.a)(l,2),f=s[0],m=s[1],j=Object(n.useState)(e.isMulti?[]:null),v=Object(i.a)(j,2),O=v[0],g=v[1],x=Object(n.useState)(""),y=Object(i.a)(x,2),C=y[0],w=y[1],F=e.name,k=e.value,S=e.onChange,T=e.options,E=e.optionLabelKey,R=void 0===E?"title":E,P=e.optionValueKey,L=void 0===P?"id":P,I=e.isMulti,A=void 0!==I&&I,V=e.title,B=e.fetchAPI,J=e.inline,K=e.InputProps,U=e.error,H=e.filterSelectedOptions,D=void 0!==H&&H,z=e.disableCloseOnSelect,W=void 0===z||z,X=e.readOnly,Y=void 0!==X&&X,q=e.concatValue,G=Object(N.a)(e,["name","value","onChange","options","optionLabelKey","optionValueKey","isMulti","title","fetchAPI","inline","InputProps","error","filterSelectedOptions","disableCloseOnSelect","readOnly","concatValue"]),Q=Te(),Z=Object(n.useState)(!1),$=Object(i.a)(Z,2),ee=$[0],te=$[1],ae=r.a.useCallback((function(e){return T&&T.find((function(t){return t&&t[Me(L)]===e.trim()}))}),[T,L]);function ne(){return(ne=Object(d.a)(u.a.mark((function e(){var t,a=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=a.length>0&&void 0!==a[0]?a[0]:"",w(t);case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re=ge((function(){return ne.apply(this,arguments)}),400);function oe(e){"Backspace"===e.key&&O&&O[Me(R)]===C&&S(null,"backspace")}function ce(e,t){S("string"===typeof k?A?e.map((function(e){return e&&e[Me(L)]})).join(",")||[]:e&&e[Me(L)]:e,t)}Object(n.useEffect)((function(){var e=!0;return o&&(m([]),te(!0),B?Object(d.a)(u.a.mark((function t(){var a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,B({search:C});case 2:a=t.sent,e&&(m(a),te(!1));case 4:case"end":return t.stop()}}),t)})))():(m(T),te(!1))),function(){e=!1,te(!1)}}),[B,T,C,o]),Object(n.useEffect)((function(){if("string"===typeof k){var e=k.split(",");g(A?e.map((function(e){return ae(e)})):ae(e[0]))}else g(k||(A?[]:null))}),[k,A,ae]);var ie=function(e){return"metaJsonModel"===(e&&e.type)?"".concat(e&&e[Me(R)]?e[Me(R)]:""," (Custom model)")||!1:"fieldName"===F?"".concat(Ce(e&&e.title?e.title:"")," (").concat(e&&e[Me(R)],")"):e?e[Me(R)]&&q&&e[Me(L)]?"".concat(e[Me(R)]," (").concat(e[Me(L)],")"):e[Me(R)]?e[Me(R)]:e.name?e.name:e.id?e.id.toString():"":""};return Object(Se.jsx)(M.a,Object(b.a)(Object(b.a)({getOptionSelected:function(e,t){return A?e[Me(L)]===t[Me(L)]:ie(e)===ie(t)},getOptionLabel:function(e){return ie(e)},loading:ee,id:_()("select-widget"),open:o,onOpen:function(){return c(!0)},onClose:function(){return c(!1)},disabled:Y,value:O?A?Array.isArray(O)?O:[]:O:A?[]:null,onChange:function(e,t,a){return ce(t,a)},options:f||[],multiple:A,filterSelectedOptions:D,onInputChange:function(e,t){return re(t)},classes:{option:"menu-item"},renderInput:function(e){return Object(Se.jsx)(p.a,Object(b.a)(Object(b.a)({},e),{},{error:U,label:J?"":V,fullWidth:!0,onClick:function(){Y||c(!0)},InputProps:Object(b.a)(Object(b.a)(Object(b.a)({},K),e.InputProps),{},{endAdornment:Object(Se.jsxs)(r.a.Fragment,{children:[ee?Object(Se.jsx)(h.a,{className:Q.circularProgress,size:15}):null,e.InputProps.endAdornment]})})},A?{}:{onKeyDown:oe}))}},A?{disableCloseOnSelect:W}:{}),G))}var Ee=a(232),Re=a(234),Pe=a(236),Le=a(231),Ie=a(235),Ae=a(230),Ve=a(175),Be=a(233),Je=a(222),Ke=a(242),Ue=a(223),He=a(224),De=a(226),ze=a(241),We=a(227),Xe=Object(w.a)({popover:{maxHeight:"90%"},cardContent:{overflow:"auto",maxHeight:"80%",minWidth:250},cardContentItemText:{fontSize:12,lineHeight:.5,paddingBottom:8},cardContentItemTitle:{fontSize:16},cardActionView:{justifyContent:"flex-end"},noFields:{textAlign:"center",color:"gray"}});function Ye(e){var t=e.data,a=e.icon,n=(e.title,e.iconButton),o=void 0!==n&&n,c=e.buttonClassName,l=e.buttonTitle,u=e.onSubmit,s=e.iconButtonClassName,d=(e.contentHeight,Xe()),b=r.a.useState(!1),p=Object(i.a)(b,2),j=p[0],h=p[1],g=r.a.useState([]),x=Object(i.a)(g,2),y=x[0],C=x[1],w=Object.values(t).filter((function(e){return!1!==e.isRemoved})),F=r.a.useCallback((function(e){e.stopPropagation(),h(!0)}),[]),N=r.a.useCallback((function(e){e.stopPropagation(),h(!1),C([])}),[]),S=r.a.useCallback((function(e){e.stopPropagation();var t=w.filter((function(e,t){return-1!==y.indexOf("".concat(t))}));u&&u(t),N(e)}),[u,y,N,w]),M=r.a.useCallback((function(e){e.stopPropagation();var t=e.target,a=t.value;t.checked;C((function(e){return-1!==e.indexOf(a)?Object(f.a)(e.filter((function(e){return e!==a}))):[].concat(Object(f.a)(e),[a])}))}),[]);return Object(Se.jsxs)(r.a.Fragment,{children:[o?Object(Se.jsx)(O.a,{color:"primary",onClick:F,className:k()(s),children:a}):Object(Se.jsx)(Je.a,{id:"addField",variant:"contained",color:"default",startIcon:a,className:c,onClick:F,children:l}),Object(Se.jsxs)(Ke.a,{fullWidth:!0,scroll:"paper",open:j,onClose:N,"aria-labelledby":"scroll-dialog-title",children:[Object(Se.jsx)(Ue.a,{id:"scroll-dialog-title",children:"Select Fields"}),Object(Se.jsxs)(He.a,{dividers:!0,classes:{root:d.cardContent},children:[w.map((function(e,t){return Object(Se.jsx)(m.a,{container:!0,children:Object(Se.jsx)(De.a,{control:Object(Se.jsx)(ze.a,{onChange:M,value:t,checked:-1!==y.indexOf("".concat(t))}),label:Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsx)(v.a,{className:d.cardContentItemTitle,children:e.title}),Object(Se.jsx)(v.a,{className:d.cardContentItemText,children:e.name})]})})},t)})),0===w.length&&Object(Se.jsx)(v.a,{className:d.noFields,children:"No fields available"})]}),Object(Se.jsxs)(We.a,{className:d.cardActionView,children:[Object(Se.jsx)(Je.a,{variant:"contained",color:"secondary",onClick:N,children:"Close"}),Object(Se.jsx)(Je.a,{variant:"contained",color:"primary",onClick:S,children:"Submit"})]})]})]})}var qe=r.a.memo(Ye),Ge=a(122),Qe=a.n(Ge),Ze=Object(w.a)({container:{display:"flex"},input:{width:"100%",display:"flex",position:"relative","& > div:before":{border:0}},parentField:{marginRight:5,color:"#3f51b5"},clickableView:{cursor:"pointer","& input":{cursor:"pointer"}},fieldName:{fontSize:12},fieldNameColumn:{width:"unset"},addFieldButton:{padding:0,marginLeft:5}}),$e=function(e){var t=e.type.replace(/-/g,"_").toLowerCase();return-1!==I.indexOf(t)};function et(e){var t=Ze(),a=e.item,n=e.handleAdd,o=r.a.useState(!1),c=Object(i.a)(o,2),l=c[0],u=c[1],s=function(e){if($e(e)){var t=e.value;return(null===t||void 0===t?void 0:t.fields)||null}return null}(a);return r.a.useEffect((function(){a&&$e(a)&&a.subFieldName&&u(!0)}),[a]),a?Object(Se.jsxs)("div",{className:k()(t.input),children:[Object(Se.jsx)(m.a,{container:!0,direction:"column",className:t.fieldNameColumn,children:Object(Se.jsx)(v.a,{title:a.name,children:a.title||a.autoTitle||a.name})}),Object(Se.jsx)("div",{children:s&&l&&Object(Se.jsx)(qe,{data:s,iconButton:!0,onSubmit:function(e){return n(e)},icon:Object(Se.jsx)(Qe.a,{}),buttonTitle:"Add Fields",iconButtonClassName:t.addFieldButton})})]}):null}var tt=r.a.memo(et),at=a(217);function nt(e){var t=e.name,a=e.title,n=e.autoTitle,o=e.value,c=void 0===o?"":o,l=(e.onChange,e.onBlur),u=e.readOnly,s=e.inline,d=e.InputProps,f=e.style,m=Object(N.a)(e,["name","title","autoTitle","value","onChange","onBlur","readOnly","inline","InputProps","style"]),j=r.a.useState(),v=Object(i.a)(j,2),O=v[0],h=v[1];return r.a.useEffect((function(){h(c)}),[c]),s?Object(Se.jsx)(at.a,Object(b.a)({style:Object(b.a)({width:"100%"},f),placeholder:a,inputProps:{"aria-label":a},name:t,onChange:function(e){return h(e.target.value)},onBlur:function(e){return l(e.target.value)},autoComplete:"off",readOnly:u,disabled:u,value:O||""},m)):Object(Se.jsx)(p.a,Object(b.a)({label:a||n,name:t,style:Object(b.a)({width:"100%"},f),onChange:function(e){return h(e.target.value)},onBlur:l,autoComplete:"off",InputProps:Object(b.a)({readOnly:u},d),value:O||"",className:m.className},m))}nt.defaultProps={rows:3,readOnly:!1};var rt=nt;function ot(e){var t=e.type,a=void 0===t?"integer":t,o=e.title,c=e.onChange,l=e.value,u=void 0===l?0:l,s=(e.readOnly,e.scale),d=void 0===s?2:s,f=(e.customeFormat,e.onBlur),m=Object(N.a)(e,["type","title","onChange","value","readOnly","scale","customeFormat","onBlur"]),p=Object(n.useState)(u),j=Object(i.a)(p,2),v=j[0],O=j[1],h=Object(n.useCallback)((function(e){return Number(Number(e).toFixed("integer"===a?0:d))}),[a,d]);return r.a.useEffect((function(){O(h(u))}),[u,O,h]),Object(Se.jsx)(rt,Object(b.a)({onChange:O,title:o,type:"number",value:"".concat(v),onBlur:function(e){c(h(e.target.value)),O(h(e.target.value)),f&&f(e)}},m))}ot.defaultProps={readOnly:!1};var ct=ot,it=a(123),lt=a(228),ut=a(229),st=a(238),dt=a(21),ft={date:lt.a,time:ut.a,datetime:st.a};var bt=function(e){var t=e.inline,a=e.type,o=void 0===a?"date":a,c=Object(N.a)(e,["inline","type"]),l=Object(n.useState)(!1),u=Object(i.a)(l,2),s=u[0],d=u[1],f=r.a.useRef(),m=(c.name,c.title),p=c.format,j=(c.error,c.onChange),v=Object(N.a)(c,["name","title","format","error","onChange"]),O=ft[o];return r.a.useEffect((function(){s&&(f.current=v.value)}),[s,v.value]),Object(Se.jsx)(dt.a,{utils:it.a,children:Object(Se.jsx)(O,Object(b.a)(Object(b.a)(Object(b.a)(Object(b.a)({autoOk:!0,open:s,ampm:!1,views:"date"===o?["date"]:"datetime"===o?["date","hours","minutes"]:"time"===o?["hours","minutes","seconds"]:["date"],onChange:function(e){f.current=e,j(e)},PopoverProps:{anchorOrigin:{vertical:"bottom",horizontal:"left"},transformOrigin:{vertical:"top",horizontal:"left"}},disableToolbar:!0,variant:"inline"},t?{invalidDateMessage:""}:{}),{},{style:Object(b.a)({width:"100%"},t?{margin:0}:{}),label:t?"":m,format:p||L[o]},"time"!==o?{animateYearScrolling:!1}:{}),v),{},{onKeyDown:function(e){40===e.keyCode&&d(!0)},onClose:function(){j(f.current),d(!1)},onOpen:function(){return d(!0)}}))})},mt=a(247),pt=a(219),jt=a(246),vt=a(239),Ot=Object(w.a)((function(e){return{root:{display:"flex",flexWrap:"wrap"},select:{width:"100%"}}}));function ht(e){var t=e.name,a=e.value,n=void 0===a?"":a,r=e.onChange,o=e.options,c=e.title,i=e.className,l=Object(N.a)(e,["name","value","onChange","options","title","className"]),u=Ot();return Object(Se.jsxs)(pt.a,{className:k()(u.formControl,i),children:[Object(Se.jsx)(jt.a,{children:c}),Object(Se.jsx)(vt.a,Object(b.a)(Object(b.a)({value:n,onChange:function(e){return r(e.target.value)},name:t,style:{marginRight:8},classes:{select:u.select}},l),{},{children:o&&Array.isArray(o)&&o.map((function(e,t){var a=e.name,n=e.title;return Object(Se.jsx)(mt.a,{value:a,children:n},t)}))}))]})}Object(w.a)({container:{display:"flex",flexDirection:"row"},selection:{minWidth:150,marginRight:20}});var gt=a(243),xt=a(125),yt=a.n(xt),Ct=Object(w.a)((function(e){return{root:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0},chip:{margin:e.spacing(.5)},rightIcon:{width:"0.8em",height:"0.8em"}}})),wt=function(e){return"_selectId"===e?"id":e};var Ft=function(e){var t=e.sourceModel,a=e.value,n=e.onChange,o=e.parentRow,c=e.targetModel,i=e.isContext,l=void 0!==i&&i,s=e.isM2o,f=void 0!==s&&s,m=Object(N.a)(e,["sourceModel","value","onChange","parentRow","targetModel","isContext","isM2o"]),p=Ct(),j=function(){if(Array.isArray(a)&&a.length){var e=a.filter((function(e){return e.name})),n=e[e.length-1];return l&&e.length-1===0?n:"com.axelor.meta.db.MetaJsonRecord"===n.model&&n.targetModel?{fullName:n.targetModel}:n.target?{fullName:n.target}:{fullName:n.model}}return t||(o?{fullName:o.target}:c||void 0)},v=r.a.useCallback((function(e,t){if("remove-option"===t){var r=function(e,t){for(var a,n=function(n){var r=e[n];if(-1===t.findIndex((function(e){return e.name===r.name})))return a=n,"break"},r=0;r<e.length&&"break"!==n(r);r++);return a}(a,e);r&&e.splice(r,e.length-1)}n(e)}),[a,n]),O=function(e){var t=m.optionLabelKey,a=m.optionValueKey,n=m.concatValue,r=m.name;return"metaJsonModel"===(e&&e.type)?"".concat(e&&e[wt(t)]?e[wt(t)]:""," (Custom model)")||!1:"fieldName"===r?"".concat(Ce(e&&e.title?e.title:"")," (").concat(e&&e[wt(t)],")"):e?e[wt(t)]&&n&&e[wt(a)]?"".concat(e[wt(t)]," (").concat(e[wt(a)],")"):e[wt(t)]?e[wt(t)]:e.name?e.name:e.id?e.id.toString():"":""};return Object(Se.jsx)("div",{className:m.containerClassName,children:Object(Se.jsx)(_e,Object(b.a)({title:e.title,isMulti:!0,fetchAPI:Object(d.a)(u.a.mark((function e(){var n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t&&a&&a[0])){e.next=3;break}if("SOURCE"!==a[0].title){e.next=3;break}return e.abrupt("return",[]);case 3:if(!l||Array.isArray(a)&&a.length){e.next=9;break}return e.next=6,Y();case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,ae(j());case 11:e.t0=e.sent;case 12:return n=e.t0,t&&(!a||a.length<1)&&(r=Object.assign({},t,{title:"SOURCE"}),n.splice(0,0,Object(b.a)({},r))),f&&a&&a.length>0&&(n=n.filter((function(e){return["many_to_one","one_to_one"].includes(e.type.toLowerCase())&&!E.includes(e.name)}))),e.abrupt("return",n);case 16:case"end":return e.stop()}}),e)}))),value:a,onChange:v,renderTags:function(e,t){return e.map((function(a,n){return Object(Se.jsxs)(r.a.Fragment,{children:[Object(Se.jsx)(gt.a,Object(b.a)({label:O(a),className:p.chip},t({index:n}))),n<e.length-1&&Object(Se.jsx)(yt.a,{className:p.rightIcon})]},n)}))}},m))})},kt=Object(w.a)((function(e){return{root:{width:"100%",overflowX:"auto",height:"92vh",overflowY:"auto"},table:{minWidth:650,"& td":{padding:"0px 16px !important"}},tableRowRoot:{"&:nth-of-type(odd)":{backgroundColor:e.palette.action.hover},"& .MuiInput-underline:before":{borderBottom:0}},input:{width:"100%"},error:{fontSize:"0.7em",position:"absolute",paddingTop:1,color:"red",fontWeight:"bold"},valueInputContainer:{position:"relative"},radioInput:{padding:4},iconButton:{padding:"8px",marginTop:7},deleteIcon:{color:"#0275d8"},headerTitle:{paddingLeft:0,textAlign:"center"}}})),Nt=(R.SELF,R.CONTEXT,R.NONE,function(e){return e.type.replace(/-/g,"_").toLowerCase()}),St=function(e,t,a){var n=[{title:"Self",id:R.SELF},{title:"Context",id:R.CONTEXT},{title:"Expression",id:R.NONE},{title:"Source",id:R.SOURCE}],r=Object(B.get)(t,"value.from",a);return t&&[R.CONTEXT,R.SELF,R.SOURCE].includes(r)&&n.push({title:"Parent",id:R.PARENT}),n},Mt=function(e){var t,a=(e.value||{}).selected;return a&&"object"===typeof a.value?a.value:(a&&(t=a.value),{name:t})},Tt=function(e){var t=(e.value||{}).selected,a=void 0===t?{}:t;if(a)return ke(e.type)?Object(s.a)({},a.targetName,a.value):a.value},_t=function(e){var t={};return e.subField&&(t.borderBottom="0px"),t},Et=function(e,t,a){var n;return e.id===R.PARENT?!(null===t||void 0===t||null===(n=t.value)||void 0===n?void 0:n.selected):e.id===R.SOURCE&&!a},Rt=function(e,t){var a=e.contextModel,n=Object(B.get)(e,"value.from",t);return a&&"context"===n?{fullName:a.target}:[R.SELF,R.SOURCE,R.PARENT].includes(n)?{fullName:Mt(e).target}:{}},Pt=function(e,t,a){var n;(t&&t[e.targetName]&&(n=e.targetName),!n&&a&&t&&t[a]&&(n=a),n)||(n=(t?t.name:null)?"name":"_selectId");return n};function Lt(e){e.operator;var t=e.editor,a=e.internalProps,r=(e.parentType,a.onChange),o=a.value,c=Object(N.a)(a,["onChange","value"]),l=kt(),s=c.field,f=void 0===s?{}:s,m=f.targetName,p=f.target,j=f.targetModel,v=(f.model,f.jsonTarget,Object(n.useState)(null)),O=Object(i.a)(v,2),h=O[0],g=O[1],x=function(){var e=Object(d.a)(u.a.mark((function e(){var t,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=[],j||f["targetJsonModel.name"],"com.axelor.meta.db.MetaJsonRecord"!==p||!f.domain){e.next=12;break}return e.next=5,se(f.domain);case 5:return t=e.sent,e.next=8,fe(f.jsonTarget);case 8:a=e.sent,g(a&&a.name),e.next=15;break;case 12:return e.next=14,me(p||j);case 14:t=e.sent;case 15:return e.abrupt("return",t);case 16:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=o._selectId?Object(b.a)(Object(b.a)({},o),{},{id:o._selectId}):o;return Object(Se.jsx)(_e,{name:"fieldValue",title:"Value",placeholder:"Value",fetchAPI:x,isMulti:!1,optionValueKey:m,optionLabelKey:m,onChange:function(e){"string"!==typeof e&&(e&&e.length>0?e.find((function(e){return e[m]})):e[m]),r({name:"fieldValue",value:e,nameField:h},t)},value:y||[],classes:{root:l.MuiAutocompleteRoot}})}function It(e){var t=e.Component,a=(e.operator,e.editor),n=e.internalProps,r=n.onChange,o=n.value,c=(n.value2,n.classes,n.style),i=(n.targetName,Object(N.a)(n,["onChange","value","value2","classes","style","targetName"]));return Object(Se.jsx)(t,Object(b.a)({name:"fieldValue",onChange:function(e){return r({name:"fieldValue",value:e},a)},value:o,style:c},i))}var At=r.a.memo((function(e){var t=e.type,a=e.operator,n=void 0===a?"=":a,r=e.onChange,o=e.value,c=e.classes,i=e.parentType,l=e.editor,u=Object(N.a)(e,["type","operator","onChange","value","classes","parentType","editor"]),s=Object(b.a)({value:o.fieldValue,value2:o.fieldValue2,onChange:r},u),d=[],f={};switch(t){case"one_to_one":case"many_to_one":case"many_to_many":case"one_to_many":case"json_one_to_one":case"json_many_to_one":case"json_many_to_many":case"json_one_to_many":return Object(Se.jsx)(Lt,{operator:n,editor:l,internalProps:Object(b.a)(Object(b.a)({},s),{},{value:o.fieldValue}),parentType:i});case"date":case"time":case"datetime":return Object(Se.jsx)(It,{Component:bt,operator:n,editor:l,internalProps:Object(b.a)(Object(b.a)({type:t,value:function(e){return e?he()(e,L[t]):null}(o.fieldValue),onChange:function(e,a){var n=e.name,o=e.value;return r({name:n,value:o&&o.format(L[t])},a)}},u),{},{margin:"none",classes:c,style:{width:"250px !important"}})});case"integer":case"long":case"decimal":return f={Component:(d=u.field.selectionList&&u.field.selectionList.map((function(e){var t=e.title,a=e.value,n=e.data;return{name:n&&n.value||a,title:t}})))?ht:ct,operator:n,editor:l,internalProps:Object(b.a)({},d?Object(b.a)({options:d,classes:c},s):Object(b.a)(Object(b.a)({type:t},s),{},{margin:"none",classes:c,style:{width:"250px !important"}}))},Object(Se.jsx)(It,Object(b.a)({},f));case"enum":return d=u.field.selectionList.map((function(e){var t=e.title,a=e.value,n=e.data;return{name:n&&n.value||a,title:t}})),Object(Se.jsx)(It,{Component:ht,operator:n,editor:l,internalProps:Object(b.a)({options:d,classes:c},s)});case"boolean":var m=[{title:"Yes",value:!0},{title:"No",value:!1}];return Object(Se.jsx)(_e,{optionLabelKey:"title",optionValueKey:"value",options:m,value:m.find((function(e){return e.value===o.fieldValue})),onChange:function(e){return r({value:e.value})}});default:return f={Component:(d=u.field&&u.field.selectionList&&u.field.selectionList.map((function(e){var t=e.title,a=e.value,n=e.data;return{name:n&&n.value||a,title:t}})))?ht:rt,operator:n,editor:l,internalProps:Object(b.a)({},d?Object(b.a)(Object(b.a)({options:d,classes:c},s),{},{value:o.fieldValue,className:c.input}):Object(b.a)(Object(b.a)({classes:c},s),{},{onBlur:function(e){return s.onChange(e.target)},margin:"none",style:{width:"100%"}}))},Object(Se.jsx)(It,Object(b.a)({},f))}}));function Vt(e){var t=kt(),a=e.onRowChange,n=e.data,o=void 0===n?[]:n,c=e.metaFields,l=void 0===c?[]:c,s=e.onRemove,m=e.errors,p=e.onClearError,j=e.onSubFieldAdd,v=e.handleAdd,h=e.sourceModel,g=e.targetModel,x=r.a.useState([{name:void 0}]),y=Object(i.a)(x,2),C=(y[0],y[1]),w=r.a.useCallback((function(){return h?R.SOURCE:R.NONE}),[h]),F=r.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(t,n,r,o){var c,i,l,s,d,f,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c=t.target.value,i=t.target.nameField,m&&m[o.dataPath]&&c&&p(o.dataPath),l=n,s=c,d=Object(B.get)(o,"value.from",w()),"value"===n&&(l="".concat(n,".selected"),f=c,b=c?Pt(o,c,i):Object(B.get)(o,"value.selected.targetName"),!ke(o.type)||d&&d!==R.NONE||"object"!==typeof f||(f="_selectId"===b?c.id:c[b]),s={value:f},d===R.NONE&&ke(o.type)&&(s.targetName=b)),(["contextModel","sourceField","selfField"].includes(n)||[R.SELF,R.SOURCE,R.PARENT].includes(d)&&"value"===n)&&a&&a(o,r,"modelSubField",[]),a&&a(o,r,l,s);case 9:case"end":return e.stop()}}),e)})));return function(t,a,n,r){return e.apply(this,arguments)}}(),[a,m,p,w]),k=(r.a.useCallback((function(e){m&&m[e]&&p(e)}),[p,m]),r.a.useCallback((function(e){s&&s(e)}),[s])),N=(r.a.useCallback((function(e){C(Object(f.a)(e))}),[]),r.a.useCallback((function(e,a){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3?arguments[3]:void 0;if(e.isRemoved||e.isHidden)return null;var c=Object(B.get)(e,"value.from",w());return Object(Se.jsxs)(r.a.Fragment,{children:[Object(Se.jsxs)(Ae.a,{classes:{root:t.tableRowRoot},children:[Object(Se.jsx)(Le.a,{style:Object(b.a)({},_t(e)),children:Object(Se.jsx)(tt,{name:"name",className:t.input,item:e,onChange:function(e){return F(e,"name",a)},onSubFieldAdd:j,handleAdd:v,onSubFieldChange:function(e){F(e,"subFieldName",a)}})}),Object(Se.jsx)(Le.a,{children:"="}),Object(Se.jsx)(Le.a,{style:Object(b.a)({},_t(e)),className:t.valueInputContainer,children:c===R.SELF?Object(Se.jsx)(Ft,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,parentRow:o,targetModel:g,value:e.modelSubField,onChange:function(t){return F({target:{value:t}},"modelSubField",a,e)}}):c===R.SOURCE?Object(Se.jsx)(Ft,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,sourceModel:h,value:e.modelSubField,onChange:function(t){return F({target:{value:t}},"modelSubField",a,e)}}):c===R.PARENT?Object(Se.jsx)(_e,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,options:l,fetchAPI:function(){return ae(Rt(o,w()))},value:Mt(e),onChange:function(t){return F({target:{value:t}},"value",a,e)}}):c===R.CONTEXT?Object(Se.jsx)(Ft,{optionValueKey:"name",optionLabelKey:"title",concatValue:!0,isContext:!0,value:e.modelSubField,onChange:function(t){return F({target:{value:t}},"modelSubField",a,e)}}):Object(Se.jsx)(At,{row:e,type:Nt(e),onChange:function(t,n){F({target:t},"value",a,e)},value:{fieldValue:Tt(e),fieldValue2:""},classes:t,field:e.subFieldName||e})}),Object(Se.jsx)(Le.a,{style:Object(b.a)({},_t(e)),size:"small",children:Object(Se.jsx)(_e,{disableClearable:!0,options:St(0,o,w()),value:c||w(),getOptionDisabled:function(e){return Et(e,o,h)},onChange:function(t){return F({target:{value:t}},"value.from",a,e)}})}),Object(Se.jsx)(Le.a,{style:void 0!==e.level?Object(b.a)({borderBottom:"0px"},_t(e)):Object(b.a)({},_t(e)),children:Object(Se.jsx)(O.a,{size:"medium",onClick:function(){return k(e)},className:t.iconButton,children:Object(Se.jsx)(Ee.a,{title:"Remove field",children:Object(Se.jsx)(Be.a,{fontSize:"small",className:t.deleteIcon})})})})]}),e.value&&"object"===typeof e.value&&Object.keys(e.value).length>0&&!e.hideFields&&Object(Se.jsx)(r.a.Fragment,{children:Object(B.get)(e,"value.fields",[]).map((function(t,a){return N(t,a,n+1,e)}))})]},"".concat(e.name,"_").concat(a))}),[t,k,F,l,j,v,h,w,g]));return Object(Se.jsx)(Ve.a,{className:t.root,children:Object(Se.jsxs)(Re.a,{className:t.table,"aria-label":"simple table",children:[Object(Se.jsx)(Ie.a,{children:Object(Se.jsxs)(Ae.a,{children:[Object(Se.jsx)(Le.a,{className:t.headerTitle,style:{width:"30%",minWidth:300},children:"Field name"}),Object(Se.jsx)(Le.a,{className:t.headerTitle,style:{width:"15px"}}),Object(Se.jsx)(Le.a,{className:t.headerTitle,style:{width:"55%",minWidth:200},children:"Value"}),Object(Se.jsx)(Le.a,{className:t.headerTitle,style:{width:"110px",minWidth:130},children:"Value from"}),Object(Se.jsx)(Le.a,{className:t.headerTitle,style:{width:"5%"}})]})}),Object(Se.jsx)(Pe.a,{children:r.a.useMemo((function(){return o.map((function(e,t){return N(e,t)}))}),[o,N])})]})})}var Bt=r.a.memo(Vt),Jt=a(126),Kt=r.a.createContext();function Ut(){return r.a.useContext(Kt)}var Ht=function(e){var t=e.children,a=function(e){var t=r.a.useState(e),a=Object(i.a)(t,2),n=a[0],o=a[1];return[n,r.a.useCallback((function(e){return o(Object(Jt.a)(e))}),[o])]}({builderFields:[]}),n=Object(i.a)(a,2),o={state:n[0],update:n[1]};return Object(Se.jsx)(Kt.Provider,{value:o,children:t})},Dt=Object(w.a)({table:{minWidth:650},input:{width:"13%",marginRight:20},metaFieldGrid:{flex:1,display:"flex",flexDirection:"column",justifyContent:"center"},newRecordSwitch:{marginTop:2},newRecordSwitchText:{display:"flex",flexDirection:"column",justifyContent:"center"},newRecordInputView:{display:"flex",flexDirection:"row",marginTop:5},modelFieldSelection:{marginRight:20,marginLeft:50},addModelFieldIcon:{marginLeft:15},saveButton:{marginLeft:10},cardContent:{overflow:"auto",height:600},cardContentItemText:{lineHeight:3},cardActionView:{justifyContent:"flex-end"},capitalizeText:{textTransform:"capitalize"},saveButtonText:{marginLeft:10},saveMessageAlert:{width:"100%",marginBottom:10,display:"flex",justifyContent:"space-between"},topView:{margin:"10px 10px 0px 10px"},searchField:{flexDirection:"row",width:"12%","& input":{paddingBottom:0}},loaderView:{position:"absolute",left:0,right:0,top:0,bottom:0,height:"100%",backgroundColor:"rgba(0,0,0,0.2)",display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center"},saveIcon:{},selectContainer:{width:"75%",marginBottom:10}}),zt=function(e){return e?R.SOURCE:R.NONE},Wt=function(e){var t="";return e.forEach((function(e){t=""===t?e.name:"".concat(t,".").concat(e.name)})),t},Xt=function(e){return e.targetJsonModel?e.targetJsonModel.id:e.targetModel},Yt=function(e){return e?e.filter((function(e){return Object.keys(e).length>0})):e},qt=function(e){return e.target&&"com.axelor.meta.db.MetaJsonRecord"!==e.target?Object(b.a)(Object(b.a)({},e),{},{fullName:e.target}):e.targetModel?Object(b.a)(Object(b.a)({},e),{},{fullName:e.targetModel}):Object(b.a)(Object(b.a)({},e),{},{modelType:P,name:e.jsonTarget})},Gt=function(e,t){var a,n=e;if(e&&(null===e||void 0===e?void 0:e.selected)&&(null===e||void 0===e||null===(a=e.selected)||void 0===a?void 0:a.value)){var r="".concat(e.selected.value).split(".");r.slice(1).map((function(e){return{name:e}}));if(t===R.CONTEXT)return{contextModel:{name:ye(r[0])}};if(t===R.SELF)return n.selected=Object(b.a)(Object(b.a)({},n.selected),{},{value:r[0]}),{value:n}}return{}},Qt=function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=a.find((function(e){return e.name===t.name}));if(!n)for(var r=0;r<a.length;r++){var o=a[r],c=Object(B.get)(o,"value.fields");if(c&&(n=e(t,c)))break}return n},Zt=function e(t,a){return t.map((function(t){var n=Object(b.a)({},t),r=!1;if(n.value&&n.value.fields){var o=e(n.value.fields,a);r=-1!==o.findIndex((function(e){return!1===e.isHidden})),n=Object(b.a)(Object(b.a)({},n),{},{value:Object(b.a)(Object(b.a)({},n.value),{},{fields:o})})}return t.name.toLowerCase().includes(a.toLowerCase())||r?n.isHidden=!1:n.isHidden=!0,n}))},$t=function e(t){var a=t.fields,n=void 0===a?[]:a,r=t.from,o=void 0===r?R.PARENT:r,c=t.shouldChangeFrom,i=void 0===c||c;return n.map((function(t){var a=Object(b.a)({},t);if(Object(B.get)(a,"value.from")===o&&(i&&(a.value.from=R.NONE),a.value&&a.value.selected&&(a=Object.assign({},Object(b.a)(Object(b.a)({},a),{},{value:Object(b.a)(Object(b.a)({},a.value),{},{selected:Object(b.a)(Object(b.a)({},a.value.selected),{},{value:null})})}))),a.modelSubField=[]),a.value&&a.value.fields){var n=Object(f.a)(e({fields:a.value.fields,from:o,shouldChangeFrom:i}));a=Object.assign({},Object(b.a)(Object(b.a)({},a),{},{value:Object(b.a)(Object(b.a)({},a.value),{},{fields:n})}))}return a}))};var ea=function(e){var t=e.params,a=Dt(),n=Ut(),o=n.state,c=n.update,l=o.builderFields,g=r.a.useState(),y=Object(i.a)(g,2),w=y[0],F=y[1],N=r.a.useState(),S=Object(i.a)(N,2),M=S[0],T=S[1],_=r.a.useState(),E=Object(i.a)(_,2),L=E[0],I=E[1],A=r.a.useState([]),V=Object(i.a)(A,2),K=V[0],U=V[1],H=r.a.useState(!1),D=Object(i.a)(H,2),z=D[0],W=D[1],X=r.a.useState(null),Y=Object(i.a)(X,2),q=(Y[0],Y[1]),Q=r.a.useState(!1),$=Object(i.a)(Q,2),ee=$[0],te=$[1],ne=r.a.useState({}),oe=Object(i.a)(ne,2),ie=oe[0],ue=oe[1],se=r.a.useState([]),de=Object(i.a)(se,2),fe=de[0],be=de[1],me=r.a.useState({}),pe=Object(i.a)(me,2),ve=pe[0],Oe=pe[1],he=r.a.useState(!1),xe=Object(i.a)(he,2),ye=(xe[0],xe[1]),Ce=r.a.useCallback((function(e){c((function(t){Object(B.set)(t,"builderFields",e)}))}),[c]),we=r.a.useCallback((function(e,t,a,n){c((function(t){var r=Object(B.get)(t.builderFields,"".concat(e.dataPath));if("value.from"===a&&[R.CONTEXT,R.SELF].includes(Object(B.get)(r,"value.from"))){var o=Object(B.get)(r,"value.fields",[]);if(o.length){var c=$t({fields:o});Object(B.set)(t.builderFields,"".concat(e.dataPath,".value.fields"),c)}}if("value.selected"===a&&[R.CONTEXT,R.SELF].includes(Object(B.get)(r,"value.from"))){var i=Object(B.get)(r,"value.fields",[]);if(i.length){var l=$t({fields:i,shouldChangeFrom:!1});Object(B.set)(t.builderFields,"".concat(e.dataPath,".value.fields"),l)}}Object(B.set)(t.builderFields,"".concat(e.dataPath,".").concat(a),n)}))}),[c]),ke=r.a.useCallback((function(e){c((function(t){Object(B.set)(t.builderFields,"".concat(e.dataPath,".isRemoved"),!0)}))}),[c]),Me=r.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(a,n){var r,o,i,l,d,f,m,p,j,v,O,h;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=32;break}if(r=a.target||Xt(a),o=ie[r],i=JSON.parse(w[t.resultMetaField]||"{}"),l=Object(B.get)(i,"fields",[]),ie[r]){e.next=24;break}if(M.modelType!==P){e.next=12;break}return e.next=9,re(Object(b.a)({},a));case 9:o=e.sent,e.next=15;break;case 12:return e.next=14,ae(qt(a));case 14:o=e.sent;case 15:ue(Object(s.a)({},r,o)),d="".concat(a.dataPath,".value.fields"),f=[],m=Qt(a,l),p=Object(B.get)(m,"value.fields",[]),Fe(o).forEach((function(e,t){var a=p.find((function(t){return t.name===e.name}))||{},n=("".concat(d,"[").concat(t,"].value"),a.value),r=Object(B.get)(a,"value.from"),o=Gt(n,r);f.push(Object(b.a)(Object(b.a)({},e),{},{dataPath:"".concat(d,"[").concat(t,"]"),from:r,value:n,hideFields:!0,isRemoved:!1,modelSubField:a.modelSubField},o))})),c((function(e){Object(B.set)(e.builderFields,"".concat(a.dataPath,".value.fields"),f),Object(B.set)(e.builderFields,"".concat(a.dataPath,".hideFields"),!1)})),e.next=30;break;case 24:j=[],v="".concat(a.dataPath,".value.fields"),O=Qt(a,l),h=Object(B.get)(O,"value.fields",[]),Fe(o).forEach((function(e,t){var a=h.find((function(t){return t.name===e.name}))||{},n=("".concat(v,"[").concat(t,"].value"),a.value),r=Object(B.get)(a,"value.from"),o=Gt(n,r);j.push(Object(b.a)(Object(b.a)({},e),{},{dataPath:"".concat(v,"[").concat(t,"]"),from:r,value:n,hideFields:!0,isRemoved:!1,modelSubField:a.modelSubField},o))})),c((function(e){Object(B.set)(e.builderFields,"".concat(a.dataPath,".value.fields"),j),Object(B.set)(e.builderFields,"".concat(a.dataPath,".hideFields"),!1)}));case 30:e.next=33;break;case 32:c((function(e){Object(B.set)(e.builderFields,"".concat(a.dataPath,".hideFields"),!0)}));case 33:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[M,ie,c,w,t]),Te=r.a.useCallback((function(e){c((function(t){e.forEach((function(e){Object(B.set)(t.builderFields,"".concat(e.dataPath,".isRemoved"),!1)}))}))}),[c]),Ee=(r.a.useCallback((function(e){Ce((function(e){return Object(f.a)(fe.map((function(t){var a=e.findIndex((function(e){return e.name===t.name}));return-1!==a?e[a]:t})))}))}),[fe,Ce]),r.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(a){var n,r,o,i,l=arguments;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=l.length>1&&void 0!==l[1]?l[1]:{},r=[],o=JSON.parse(n[t.resultMetaField]||"{}"),i=Object(B.get)(o,"fields",[]),Fe(Object(f.a)(a)).forEach((function(e,t){var a=i.findIndex((function(t){return t.name===e.name})),n=i[a]||{},o=("".concat(e.name,".value"),n.value),c=Object(B.get)(n,"value.from"),l=Gt(o,c);r.push(Object(b.a)(Object(b.a)({},e),{},{path:Ne(e),from:c,dataPath:"[".concat(t,"]"),value:o,hideFields:!0,isRemoved:!1,modelSubField:Yt(n.modelSubField),selfField:n.selfField,sourceField:n.sourceField},l))})),c((function(e){Object(B.set)(e,"builderFields",r)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[t,c])),Re=r.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(t,a){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=7;break}return e.next=3,ae(t);case 3:n=e.sent,be(Object(f.a)(n)),Oe({}),Ee(n,a);case 7:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),[Ee]),Pe=r.a.useCallback((function(e){Oe((function(t){return JSON.parse(JSON.stringify(Object(B.set)(t,e,void 0)))}))}),[]),Le=r.a.useCallback(Object(d.a)(u.a.mark((function e(){var a,n,r,o,c,i,d,f,m;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Oe({}),n=JSON.parse(w[t.resultMetaField]||"{}"),r=J(l,n,zt(L),L),o={fields:r,targetModel:M.name,sourceModel:Wt(K),sourceModelList:K,newRecord:ee,isJson:M.modelType===P},c=JSON.stringify(Object(b.a)({},o)),e.next=7,je(c,t.model);case 7:return i=e.sent,d=i||"",f=Object(b.a)(Object(b.a)({},w),{},(a={},Object(s.a)(a,t.resultMetaField,c),Object(s.a)(a,t.resultField,d),Object(s.a)(a,t.targetField,o.targetModel),Object(s.a)(a,t.sourceField,o.sourceModel),a)),W(!0),e.next=13,ce(t,f);case 13:m=e.sent,W(!1),m?(q({message:"Builder data saved successfully",severity:"success"}),F(Object(b.a)({},m))):q({message:"Failed to save builder data",severity:"error"});case 16:case"end":return e.stop()}}),e)}))),[l,t,M,w,L,ee,K]),Ie=r.a.useCallback(function(){var e=Object(d.a)(u.a.mark((function e(a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:T(a),q(null),F((function(e){var a;return Object(b.a)(Object(b.a)({},e),{},(a={},Object(s.a)(a,t.resultMetaField,null),Object(s.a)(a,t.resultField,""),a))})),Re(a);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[Re,t]),Ae=(r.a.useCallback((function(e){if(null===e){var t=$t({fields:l,from:R.SOURCE,shouldChangeFrom:!0});Ce(Object(f.a)(t))}else{var a=$t({fields:l,from:R.SOURCE,shouldChangeFrom:!1});Ce(Object(f.a)(a))}I([e])}),[l,Ce]),r.a.useCallback((function(e){ye(e.currentTarget)}),[]),r.a.useCallback((function(){ye(null)}),[]),r.a.useCallback((function(){return q(null)}),[]),ge(r.a.useCallback((function(e){var t=Zt(l,e);Ce(Object(f.a)(t))}),[l,Ce]),400)),Ve=r.a.useCallback((function(e){var t=e.target.value;Ae(t)}),[Ae]);return r.a.useEffect((function(){function e(){return(e=Object(d.a)(u.a.mark((function e(){var a,n,r,o,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t||!t.id){e.next=23;break}return e.next=3,le(t.model,t.id);case 3:if(a=e.sent,F(Object(b.a)({},a)),!a){e.next=22;break}if(!(n=JSON.parse(a[t.resultMetaField]||"{}"))){e.next=20;break}return e.next=10,G(n.targetModel);case 10:return r=e.sent,o=n.sourceModelList?n.sourceModelList[n.sourceModelList.length-1]:{},e.next=14,G(o.name);case 14:c=e.sent,U(Object(f.a)(n.sourceModelList)),T(r),I(c),te(n.newRecord),Re(r,a);case 20:e.next=23;break;case 22:q({message:"Record is not available",severity:"error"});case 23:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[t,Re]),Object(Se.jsxs)(Se.Fragment,{children:[Object(Se.jsxs)(m.a,{container:!0,children:[Object(Se.jsxs)(m.a,{container:!0,className:a.topView,children:[Object(Se.jsxs)(m.a,{container:!0,justify:"space-between",style:{marginBottom:10},children:[Object(Se.jsx)(_e,{className:a.input,name:"metaModal",title:"Target Model",placeholder:"Target Model",fetchAPI:function(e){return Z(e)},optionLabelKey:"name",onChange:function(e){return Ie(e)},value:M}),Object(Se.jsx)(p.a,{classes:{root:a.searchField},placeholder:"Search fields",onChange:function(e){return Ve(e)}}),Object(Se.jsxs)(m.a,{item:!0,className:a.newRecordInputView,children:[Object(Se.jsx)(j.a,{className:a.newRecordSwitch,checked:ee,onChange:function(e){return te(e.target.checked)}}),Object(Se.jsx)(v.a,{className:a.newRecordSwitchText,children:"New Record"})]}),Object(Se.jsx)(m.a,{item:!0,className:a.metaFieldGrid,children:Object(Se.jsxs)(m.a,{container:!0,children:[Object(Se.jsx)(qe,{data:l,onSubmit:function(e){return Te(e)},icon:Object(Se.jsx)(x.a,{}),buttonTitle:"Add Fields",iconButton:!0,buttonClassName:a.modelFieldSelection,iconButtonClassName:a.addModelFieldIcon}),Object(Se.jsx)(O.a,{classes:{colorPrimary:a.saveIcon},color:"primary",onClick:Le,className:k()(a.iconButtonClassName),children:Object(Se.jsx)(C.a,{})})]})})]}),Object(Se.jsx)(Ft,{containerClassName:a.selectContainer,title:"Source Model",optionValueKey:"name",optionLabelKey:"name",concatValue:!0,isM2o:!0,isContext:!0,value:K,onChange:function(e){U(Object(f.a)(e)),I(e[e.length-1])}})]}),Object(Se.jsx)(Bt,{builderFields:l,data:l,onRowChange:we,onRemove:ke,metaFields:fe,errors:ve,onClearError:Pe,onSubFieldAdd:Me,handleAdd:Te,sourceModel:L,targetModel:M})]}),z&&Object(Se.jsx)("div",{className:a.loaderView,children:Object(Se.jsx)(h.a,{size:32})})]})};function ta(){var e=r.a.useState(null),t=Object(i.a)(e,2),a=t[0],n=t[1];return r.a.useEffect((function(){for(var e={},t=/[?&]([^=#]+)=([^&#]*)/g,a=window.location.href,r=t.exec(a);r;)e[r[1]]=r[2],r=t.exec(a);n(e)}),[]),Object(Se.jsx)("div",{className:"App",children:Object(Se.jsx)(ea,{params:a})})}function aa(){return Object(Se.jsx)(Ht,{children:Object(Se.jsx)(ta,{})})}c.a.render(Object(Se.jsx)(aa,{}),document.getElementById("root"))}},[[173,1,2]]]);
//# sourceMappingURL=main.cba4f962.chunk.js.map